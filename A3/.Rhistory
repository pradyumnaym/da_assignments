methods = c("circle", "square", "ellipse", "number", "shade", "color", "pie")
#colors = colorRampPalette(c("red", "white", "blue"))(20)
plt = function(){
corrplot(cor_mat, #matrix of correlation
method = methods[5], #shade
type = "lower", #lower triangular matrix only
diag=FALSE, #exclude the diagonal
order="hclust", #heirarchical clustering
col = brewer.pal(n=8, name="RdBu"), #Use RColorBrewer to get a palette of blue and red gradient
tl.col="black", #color of text
tl.srt = 45, #tilt by 45 degrees
addCoef.col = "black", #Add correlation coefficients in each box
number.cex = 0.7,
tl.cex = 0.8,
main = 'Correlogram of AMES quantitative variables')
}
plt()
#corrgram(ames_quantitative, order=NULL, lower.panel=panel.shade,upper.panel=panel.pie, text.panel=panel.txt,main="Quantitative variables of AMES")
model <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model)
p <- predict(model,ames_test)
RMSE(p , ames_test$SalePrice)
R2(p , ames_test$SalePrice)
plot(model)
hist(ames_train$SalePrice)
ames_test[,"SalePrice"] <- log(ames_test[,"SalePrice"])
ames_train[,"SalePrice"] <- log(ames_train[,"SalePrice"])
hist(ames_test$SalePrice)
model2 <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model2)
p <- predict(model2,ames_test)
RMSE(p , ames_test$SalePrice)
R2(p , ames_test$SalePrice)
plot(model2)
grid = 10^seq(10, -2, length = 100)
ridge_mod = glmnet(x, y, alpha = 0, lambda = grid)
plot(model)
hist(ames_train$SalePrice)
plot(model, which = c(3))
plot(model, which = c(1,3))
plot(model)
plot(model, which = c(1,2,3))
model <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model)
p <- predict(model,ames_test)
RMSE(p , ames_test$SalePrice)
R2(p , ames_test$SalePrice)
plot(model, which = c(1,2,3))
hist(ames_train$SalePrice)
ames_test[,"SalePrice"] <- log(ames_test[,"SalePrice"])
ames_train[,"SalePrice"] <- log(ames_train[,"SalePrice"])
hist(ames_test$SalePrice)
#install.packages('corrplot')
#install.packages('RColorBrewer')
#install.packages('glmnet')
#install.packages('caret')
library(RColorBrewer)
library(corrplot)
library(glmnet)
library(caret)
# path to the Dataset
path='D:/DA_A3/'
train = "AmesHousingPrices/train.csv"
test = "AmesHousingPrices/test.csv"
ames_train = read.csv(paste(path,train,sep=""))
ames_test = read.csv(paste(path,test,sep=""))
dummy = na.omit(ames_train)
ames_quantitative = Filter(is.numeric, ames_train)
drop = c("X","Id")
ames_quantitative = ames_quantitative[,!(names(ames_quantitative) %in% drop)]
#Ref: http://www.sthda.com/english/wiki/visualize-correlation-matrix-using-correlogram
#cor() reutrns a matrix of correlation values
cor_mat = cor(ames_quantitative)
#different methods of the correlation plot
methods = c("circle", "square", "ellipse", "number", "shade", "color", "pie")
#colors = colorRampPalette(c("red", "white", "blue"))(20)
plt = function(){
corrplot(cor_mat, #matrix of correlation
method = methods[5], #shade
type = "lower", #lower triangular matrix only
diag=FALSE, #exclude the diagonal
order="hclust", #heirarchical clustering
col = brewer.pal(n=8, name="RdBu"), #Use RColorBrewer to get a palette of blue and red gradient
tl.col="black", #color of text
tl.srt = 45, #tilt by 45 degrees
addCoef.col = "black", #Add correlation coefficients in each box
number.cex = 0.7,
tl.cex = 0.8,
main = 'Correlogram of AMES quantitative variables')
}
plt()
#corrgram(ames_quantitative, order=NULL, lower.panel=panel.shade,upper.panel=panel.pie, text.panel=panel.txt,main="Quantitative variables of AMES")
model <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model)
p <- predict(model,ames_test)
RMSE(p , ames_test$SalePrice)
R2(p , ames_test$SalePrice)
plot(model, which = c(1,2,3))
hist(ames_train$SalePrice)
ames_test[,"SalePrice"] <- log(ames_test[,"SalePrice"])
ames_train[,"SalePrice"] <- log(ames_train[,"SalePrice"])
hist(ames_test$SalePrice)
model2 <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model2)
p <- predict(model2,ames_test)
RMSE(p , ames_test$SalePrice)
R2(p , ames_test$SalePrice)
plot(model2)
#grid = 10^seq(10, -2, length = 100)
#ridge_mod = glmnet(x, y, alpha = 0, lambda = grid)
hist(ames_train$SalePrice)
ames_test[,"SalePrice"] <- log(ames_test[,"SalePrice"])
ames_train[,"SalePrice"] <- log(ames_train[,"SalePrice"])
hist(ames_train$SalePrice)
#install.packages('corrplot')
#install.packages('RColorBrewer')
#install.packages('glmnet')
#install.packages('caret')
library(RColorBrewer)
library(corrplot)
library(glmnet)
library(caret)
# path to the Dataset
path='D:/DA_A3/'
train = "AmesHousingPrices/train.csv"
test = "AmesHousingPrices/test.csv"
ames_train = read.csv(paste(path,train,sep=""))
ames_test = read.csv(paste(path,test,sep=""))
dummy = na.omit(ames_train)
ames_quantitative = Filter(is.numeric, ames_train)
drop = c("X","Id")
ames_quantitative = ames_quantitative[,!(names(ames_quantitative) %in% drop)]
#Ref: http://www.sthda.com/english/wiki/visualize-correlation-matrix-using-correlogram
#cor() reutrns a matrix of correlation values
cor_mat = cor(ames_quantitative)
#different methods of the correlation plot
methods = c("circle", "square", "ellipse", "number", "shade", "color", "pie")
#colors = colorRampPalette(c("red", "white", "blue"))(20)
plt = function(){
corrplot(cor_mat, #matrix of correlation
method = methods[5], #shade
type = "lower", #lower triangular matrix only
diag=FALSE, #exclude the diagonal
order="hclust", #heirarchical clustering
col = brewer.pal(n=8, name="RdBu"), #Use RColorBrewer to get a palette of blue and red gradient
tl.col="black", #color of text
tl.srt = 45, #tilt by 45 degrees
addCoef.col = "black", #Add correlation coefficients in each box
number.cex = 0.7,
tl.cex = 0.8,
main = 'Correlogram of AMES quantitative variables')
}
plt()
#corrgram(ames_quantitative, order=NULL, lower.panel=panel.shade,upper.panel=panel.pie, text.panel=panel.txt,main="Quantitative variables of AMES")
model <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model)
p <- predict(model,ames_test)
RMSE(p , ames_test$SalePrice)
R2(p , ames_test$SalePrice)
plot(model, which = c(1,2,3))
hist(ames_train$SalePrice)
ames_test[,"SalePrice"] <- log(ames_test[,"SalePrice"])
ames_train[,"SalePrice"] <- log(ames_train[,"SalePrice"])
hist(ames_train$SalePrice)
model2 <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model2)
p <- predict(model2,ames_test)
RMSE(p , ames_test$SalePrice)
R2(p , ames_test$SalePrice)
plot(model2)
#grid = 10^seq(10, -2, length = 100)
#ridge_mod = glmnet(x, y, alpha = 0, lambda = grid)
model2 <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model2)
p <- predict(model2,ames_test)
print(
paste(
"The RMS Error for the model on the test set is:",
RMSE(p , ames_test$SalePrice)
)
)
print(
paste(
"The R2 value is:",
R2(p , ames_test$SalePrice)
)
)
plot(model2)
model <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model)
p <- predict(model,ames_test)
print(
paste(
"The RMS Error for the model on the test set is:",
RMSE(p , ames_test$SalePrice)
)
)
print(
paste(
"The R2 value is:",
R2(p , ames_test$SalePrice)
)
)
model <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model)
p <- predict(model,ames_test)
print(
paste(
"The RMS Error for the model on the test set is:",
RMSE(p , ames_test$SalePrice)
)
)
print(
paste(
"The R2 value is:",
R2(p , ames_test$SalePrice),
summary(model)$r.squared
)
)
model2 <- lm(SalePrice ~ . -X -Id, ames_train)
summary(model2)
p <- predict(model2,ames_test)
print(
paste(
"The RMS Error for the model on the test set is:",
RMSE(p , ames_test$SalePrice)
)
)
print(
paste(
"The R2 value is:",
summary(model2)$r.squared
)
)
plot(model2)
model <- lm(SalePrice ~ . -X -Id, ames_train)
#summary(model)
p <- predict(model,ames_test)
print(
paste(
"The RMS Error for the model on the test set is:",
RMSE(p , ames_test$SalePrice)
)
)
print(
paste(
"The R2 value is:",
summary(model)$r.squared
)
)
model2 <- lm(SalePrice ~ . -X -Id, ames_train)
#summary(model2)
p <- predict(model2,ames_test)
print(
paste(
"The RMS Error for the model on the test set is:",
RMSE(p , ames_test$SalePrice)
)
)
print(
paste(
"The R2 value is:",
summary(model2)$r.squared
)
)
plot(model2)
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = 10^seq(10, -2, length = 12)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = 10^seq(10, -2, length = 100)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = 10^seq(10, -2, length = 30)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = 10^seq(10, -2, length = 1)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = 10^seq(10, -2, length = 100)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = 10^seq(10, -2, length = 100)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = 10^seq(-2,10, length = 100)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = 10^seq(10, -2, length = 100)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = e^seq(10, -2, length = 100)
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = 2.78^seq(10, -2, length = 100)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = exp(1)^seq(10, -2, length = 100)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = exp(1)^seq(10, -10, length = 100)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
train = "ShenzhenHousingPrices/train.csv"
test = "ShenzhenHousingPrices/test.csv"
shen_train = read.csv(paste(path,train,sep=""))
shen_test = read.csv(paste(path,test,sep=""))
#dummy = na.omit(shen_train)
drop = c("SalePrice")
X_train = data.matrix(shen_train[,!(names(shen_train) %in% drop)])
y_train = data.matrix(subset(shen_train,select = drop))
X_test = data.matrix(shen_test[,!(names(shen_test) %in% drop)])
y_test = data.matrix(subset(shen_test,select = drop))
grid = exp(1)^seq(10, -2, length = 100)
ridge_mod = glmnet(X_train, y_train, alpha = 0, lambda = grid)
cv_fit <- cv.glmnet(X_train, y_train, alpha = 0, lambda = grid)
plot(cv_fit)
best_lambda = cv_fit$lambda.min
print(paste("Best lambda: ",best_lambda,sep=""))
p = predict(ridge_mod,s = best_lambda, newx = X_test)
print(paste("RMSE: ",RMSE(p , y_test),sep=""))
print(paste("R2: ",R2(p , y_test),sep=""))
#install.packages('corrplot')
#install.packages('RColorBrewer')
#install.packages('glmnet')
#install.packages('caret')
library(RColorBrewer)
library(corrplot)
library(glmnet)
library(caret)
# path to the Dataset
path='~/Desktop/Data_analytics/Assignment_3/'
train = "AmesHousingPrices/train.csv"
test = "AmesHousingPrices/test.csv"
ames_train = read.csv(paste(path,train,sep=""))
